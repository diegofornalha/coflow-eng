---
layout: PostLayout
metaTitle: Escreva Contratos Inteligente em Cadence Para Votações
addTitleSuffix: true
metaTags: []
colors: colors-d
date: '2023-01-26'
featuredImage:
  type: ImageBlock
  url: >-
    /images/23/01/Escreva Contratos Inteligente em Cadence Para Votações
    diegofornalha.png
  altText: Escreva Contratos Inteligente em Cadence Para Votações
  caption: >-
    O smart contract em Cadence é um código que é executado em uma rede
    blockchain, que é uma tecnologia de banco de dados descentralizada. Ele é
    utilizado para realizar eleições de forma segura e eficiente, permitindo que
    os participantes votem em uma das propostas disponíveis e armazenando as
    contagens de votos para cada uma das propostas. O smart contract possui três
    recursos principais: MaioriaGanha, Voto e Administrar. O recurso
    MaioriaGanha é o contrato principal e define as variáveis propostas e votos,
    bem como as funções processar e init. O recurso Voto permite que os
    participantes votem em uma das propostas e armazenem suas escolhas em uma
    variável escolha. O recurso Administrar permite que o administrador
    inicialize as propostas e crie novas instâncias do recurso Voto.
  width: 800
  height: 450
media:
  type: ImageBlock
  url: >-
    /images/23/01/Escreva Contratos Inteligente em Cadence Para Votações
    diegofornalha.png
  altText: Escreva Contratos Inteligente em Cadence Para Votações
  caption: >-
    O smart contract em Cadence é um código que é executado em uma rede
    blockchain, que é uma tecnologia de banco de dados descentralizada. Ele é
    utilizado para realizar eleições de forma segura e eficiente, permitindo que
    os participantes votem em uma das propostas disponíveis e armazenando as
    contagens de votos para cada uma das propostas. O smart contract possui três
    recursos principais: MaioriaGanha, Voto e Administrar. O recurso
    MaioriaGanha é o contrato principal e define as variáveis propostas e votos,
    bem como as funções processar e init. O recurso Voto permite que os
    participantes votem em uma das propostas e armazenem suas escolhas em uma
    variável escolha. O recurso Administrar permite que o administrador
    inicialize as propostas e crie novas instâncias do recurso Voto.
  width: 800
  height: 450
bottomSections:
  - type: CtaSection
    colors: colors-e
    elementId: ''
    backgroundSize: full
    title: CoFlow
    titlePt: CoFlow
    text: >
      Nuestra empresa comparte la misma visión que Dapper Labs, que es crear
      experiencias líderes en la industria web3 y desarrollar dapps en la cadena
      de bloques Flow que proporcionen a los usuarios una forma sencilla de
      administrar sus activos y usar la cadena de bloques. Nuestra misión es
      hacer del mundo un lugar más accesible y agradable a través de la adopción
      por los consumidores de tecnologías descentralizadas.
    textPt: >
      Nossa empresa compartilha a mesma visão do Dapper Labs, que é criar
      experiências web3 líderes do setor e desenvolver dapps na blockchain da
      Flow que possibilita aos usuários uma maneira simples de gerenciar seus
      ativos e usar o blockchain. Nossa missão é tornar o mundo um lugar mais
      acessível e agradável por meio da adoção pelo consumidor de tecnologias
      descentralizadas.
    actions:
      - label: Servidor no Discord
        altText: Entrar no Discord
        url: 'https://discord.com/invite/hT8EpC5mUN'
        showIcon: true
        icon: arrowRight
        style: primary
        type: Button
    backgroundImage: null
    styles:
      self:
        height: auto
        width: narrow
        padding:
          - pt-28
          - pb-28
          - pl-4
          - pr-4
        alignItems: center
        justifyContent: center
        flexDirection: col
      title:
        textAlign: left
      text:
        textAlign: left
      actions:
        justifyContent: flex-start
metaDescription: >-
  O smart contract em Cadence é um código que é executado em uma rede
  blockchain, que é uma tecnologia de banco de dados descentralizada. Ele é
  utilizado para realizar eleições de forma segura e eficiente, permitindo que
  os participantes votem em uma das propostas disponíveis e armazenando as
  contagens de votos para cada uma das propostas. O smart contract possui três
  recursos principais: MaioriaGanha, Voto e Administrar. O recurso MaioriaGanha
  é o contrato principal e define as variáveis propostas e votos, bem como as
  funções processar e init. O recurso Voto permite que os participantes votem em
  uma das propostas e armazenem suas escolhas em uma variável escolha. O recurso
  Administrar permite que o administrador inicialize as propostas e crie novas
  instâncias do recurso Voto.
socialImage: >-
  /images/23/01/Escreva Contratos Inteligente em Cadence Para Votações
  diegofornalha.png
titlePt: Escreva Contratos Inteligente em Cadence Para Votações
excerptBr: >-
  O smart contract em Cadence é um código que é executado em uma rede
  blockchain, que é uma tecnologia de banco de dados descentralizada. 
markdown_content_pt: >
  Hoje nós vamos ver como é fácil programar seu primeiro smart contract em
  Cadence de votação, ele sem dúvidas é o verdadeiro mestre das eleições!


  Ele permite que os participantes votem em uma das propostas disponíveis e
  armazena as contagens de votos para cada uma das propostas.


  Ele possui três recursos principais:


  MaioriaGanha,


  Voto e


  Administrar.


  Com esses recursos, o smart contract em Cadence é capaz de realizar eleições
  de forma eficiente e segura.


  O recurso MaioriaGanha é o contrato principal e define as variáveis propostas
  e votos, bem como as funções processar e init.


  A variável propostas é uma lista de strings que armazena as propostas
  disponíveis para votação, enquanto a variável votos é um dicionário que
  armazena a contagem de votos para cada uma das propostas.


  A função processar é usada para processar um voto quando um participante
  decide finalizá-lo, enquanto a função init é chamada quando o contrato é
  criado e inicializa as variáveis propostas e votos com valores vazios e salva
  uma instância do recurso Administrar na storage do contrato.


  O recurso Voto é usado para permitir que os participantes votem em uma das
  propostas e armazenar suas escolhas em uma variável escolha.


  Quando uma nova instância do recurso Voto é criada, a função init é chamada
  para inicializar a variável escolha com um dicionário vazio e preencher o
  dicionário com as propostas disponíveis. O participante pode chamar a função
  vote para votar em uma das propostas, passando o índice da proposta como
  argumento.


  O recurso Administrar permite que o administrador inicialize as propostas e
  crie novas instâncias do recurso Voto. A função inicializePropostas é usada
  para atribuir a lista de propostas fornecida à variável propostas do contrato
  principal e inicializar a variável votos com um dicionário vazio, com chaves
  correspondentes a cada uma das propostas.


  A função emitirVoto é usada para criar uma nova instância do recurso Voto e
  retorná-la.


  Espero que isso tenha ajudado a esclarecer o que o seu smart contract está
  fazendo de forma mais detalhada e descontraída. Se você tiver mais perguntas
  ou precisar de mais assistência, não hesite em perguntar.

  pub contract MaioriaGanha {

  pub var propostas: \[String]

  pub let votos: {Int: Int}


  ```

  pub resource Voto {
      pub let propostas: [String]
      pub var escolha: {Int: Bool}

      init() {
          self.propostas = MaioriaGanha.propostas
          self.escolha = {}
          var i = 0
          while i < self.propostas.length {
              self.escolha[i] = false
              i = i + 1
          }
      }
      pub fun vote(propostas: Int) {
          pre {
              propostas >= 0
              propostas < self.propostas.length
          }
          self.escolha[propostas] = true
      }
  }


  pub resource Administrar {
      pub fun inicializePropostas(_ propostas: [String]) {
          pre {
              MaioriaGanha.propostas.length == 0
              propostas.length > 0
          }
          MaioriaGanha.propostas = propostas

          var i = 0
          while i < propostas.length {
              MaioriaGanha.votos[i] = 0
              i = i + 1
          }
      }

      pub fun emitirVoto(): @Voto {
          return <-create Voto()
      }
  }


  pub fun processar(voto: @Voto) {
      var index = 0
      while index < self.propostas.length {
          if voto.escolha[index]! {
              self.votos[index] = self.votos[index]! + 1
          }
          index = index + 1;
      }
      destroy voto
  }

  init() {
      self.propostas = []
      self.votos = {}

      self.account.save<@Administrar>(<-create Administrar(), to: /storage/CalcularVotos)
  }

  ```


  }

  Parece que o seu código em Cadence é uma transação que permite ao
  administrador inicializar uma lista de propostas para eventos. Quando a
  transação é executada, ela solicita ao administrador que forneça suas
  credenciais de autenticação e, em seguida, usa essas credenciais para obter
  uma referência para o recurso Administrar do contrato MaioriaGanha.


  Em seguida, a função inicializePropostas é chamada no recurso Administrar,
  passando uma lista de três cidades como argumento: Rio de Janeiro, São Paulo e
  Floripa.


  Essa função atribui a lista de propostas fornecida à variável propostas do
  contrato principal e inicializa a variável votos com um dicionário vazio, com
  chaves correspondentes a cada uma das propostas.


  Por fim, a transação exibe uma mensagem de log informando que as sugestões de
  locais para eventos foram publicadas.

  import MaioriaGanha from 0x01


  transaction {

  prepare(admin: AuthAccount) {


  ```
      let adminRef = admin.borrow<&MaioriaGanha.Administrar>(from: /storage/CalcularVotos)!

      adminRef.inicializePropostas(
          ["Rio de Janeiro", "Sao Paulo","Floripa" ]
      )

      log("Sugestoes de Locais para Eventos Publicada!")
  }

  ```


  }

  Agora veremos um contrato de uma transação que permite a um eleitor emitir um
  voto em uma das propostas disponíveis em um contrato MaioriaGanha

  . Quando a transação é executada, ela solicita ao administrador e ao eleitor
  que forneçam suas credenciais de autenticação.


  Em seguida, a transação obtém uma referência para o recurso Administrar do
  contrato MaioriaGanha e chama a função emitirVoto nesse recurso. A função
  emitirVoto cria uma nova instância do recurso Voto e retorna uma referência
  para ela.


  Em seguida, a transação salva a instância do recurso Voto na storage do
  eleitor e exibe uma mensagem de log informando que o acesso foi concedido.

  import MaioriaGanha from 0x01


  transaction {

  prepare(admin: AuthAccount, eleitor: AuthAccount) {


  ```
      let adminRef = admin.borrow<&MaioriaGanha.Administrar>(from: /storage/CalcularVotos)!

      let voto <- adminRef.emitirVoto()

      eleitor.save<@MaioriaGanha.Voto>(<-voto, to: /storage/Voto)

      log("Acesso Concedido")
  }

  ```


  }

  Agora uma transação que permite a um eleitor emitir um voto em uma das
  propostas disponíveis em um contrato MaioriaGanha. Quando a transação é
  executada, ela solicita ao eleitor que forneça suas credenciais de
  autenticação e, em seguida, tenta carregar uma instância do recurso Voto da
  storage do eleitor.


  Se uma instância do recurso Voto for encontrada na storage do eleitor, a
  transação chama a função vote nessa instância, passando o valor 0 como
  argumento. Isso marca a primeira proposta da lista como a escolha do eleitor.


  Em seguida, a transação chama a função processar do contrato MaioriaGanha,
  passando a instância do recurso Voto como argumento. Isso adiciona o voto do
  eleitor à contagem de votos para a primeira proposta.


  Por fim, a transação exibe uma mensagem de log informando que o voto foi
  computado.

  import MaioriaGanha from 0x01


  transaction {

  prepare(eleitor: AuthAccount) {


  ```
      let voto <- eleitor.load<@MaioriaGanha.Voto>(from: /storage/Voto)!

      voto.vote(propostas: 0)

      MaioriaGanha.processar(voto: <-voto)

      log("Voto computado")
  }

  ```


  }

  Por fim, no script template.


  Quando a função é chamada, ela exibe os valores da primeira, segunda e
  terceira propostas na lista de propostas, seguidos dos respectivos valores de
  votos.


  A função usa os índices 0, 1 e 2 para acessar os elementos da lista de
  propostas e do dicionário de votos, respectivamente. Isso significa que ela
  exibirá a primeira proposta da lista, seguida do número de votos para essa
  proposta, depois a segunda proposta da lista e o número de votos para ela, e
  assim por diante.

  import MaioriaGanha from 0x01


  pub fun main() {

  log(MaioriaGanha.propostas\[0])

  log(MaioriaGanha.votos\[0])


  ```

  log(MaioriaGanha.propostas[1])

  log(MaioriaGanha.votos[1])


  log(MaioriaGanha.propostas[2])

  log(MaioriaGanha.votos[2])

  ```


  }

  Try out this Playground project
title: Escribir Smart Contracts en Cadence para Votaciones
excerpt: >-
  El smart contract en Cadence es un código que se ejecuta en una red
  blockchain, que es una tecnología de base de datos descentralizada.
author: content/data/team/people/diego-fornalha.json
---
Hoy vamos a ver cómo es fácil programar su primer smart contract en Cadence de votación, ¡sin duda el verdadero maestro de las elecciones!

Permite que los participantes voten por una de las propuestas disponibles y almacena el recuento de votos para cada una de las propuestas.

Tiene tres recursos principales:

MayoríaGana,

Voto y

Administrar.

Con estos recursos, el smart contract en Cadence es capaz de realizar elecciones de manera eficiente y segura.

El recurso MayoríaGana es el contrato principal y define las variables propuestas y votos, así como las funciones procesar e init.

La variable propuestas es una lista de strings que almacena las propuestas disponibles para votación, mientras que la variable votos es un diccionario que almacena el recuento de votos para cada una de las propuestas.

La función procesar se utiliza para procesar un voto cuando un participante decide finalizarlo, mientras que la función init se llama cuando se crea el contrato e inicializa las variables propuestas y votos con valores vacíos y guarda una instancia del recurso Administrar en la storage del contrato.

El recurso Voto se utiliza para permitir que los participantes voten por una de las propuestas y almacenar sus elecciones en una variable elección.

Cuando se crea una nueva instancia del recurso Voto, se llama a la función init para inicializar la variable elección con un diccionario vacío y completar el diccionario con las propuestas disponibles. El participante puede llamar a la función vote para votar por una de las propuestas, pasando el índice de la propuesta como argumento.

El recurso Administrar permite que el administrador inicialice las propuestas y cree nuevas instancias del recurso Voto. La función initializePropostas se utiliza para asignar la lista de propuestas proporcionada a la variable propuestas del contrato principal e inicializar la variable votos con un diccionario vacío, con claves correspondientes a cada una de las propuestas.

La función emitirVoto se utiliza para crear una nueva instancia del recurso Voto y devolverla.

Espero que esto haya ayudado a aclarar lo que su smart contract está haciendo de forma más detallada y relajada. Si tiene más preguntas o necesita más ayuda, no dude en preguntar.

```

pub contract MayoríaGana {
    pub var propuestas: [String]
    pub let votos: {Int: Int}

    pub resource Voto {
        pub let propuestas: [String]
        pub var elección: {Int: Bool}

        init() {
            self.propuestas = MayoríaGana.propuestas
            self.elección = {}
            var i = 0
            while i < self.propuestas.length {
                self.elección[i] = false
                i = i + 1
            }
        }
        pub fun vote(_ propuesta: Int) {
            pre {
                propuesta >= 0
                propuesta < self.propuestas.length
            }
            self.elección[propuesta] = true
        }
    }

    pub resource Administrar {
        pub fun initializePropostas(_ propuestas: [String]) {
            pre {
                MayoríaGana.propuestas.length == 0
                propuestas.length


```

Parece que o seu código em Cadence é uma transação que permite ao administrador inicializar uma lista de propostas para eventos. Quando a transação é executada, ela solicita ao administrador que forneça suas credenciais de autenticação e, em seguida, usa essas credenciais para obter uma referência para o recurso Administrar do contrato MayoríaGana.

Em seguida, a função inicializePropuestas é chamada no recurso Administrar, passando uma lista de três cidades como argumento: Rio de Janeiro, São Paulo e Floripa.

Essa função atribui a lista de cidades à variável propuestas do contrato principal MayoríaGana e inicializa a variável votos com um dicionário vazio, com chaves correspondentes a cada uma das propostas. Isso permite que o contrato armazene as contagens de votos para cada uma das propostas.

A função procesar é usada para processar um voto quando um participante decide finalizá-lo. Ele percorre a lista de propostas disponíveis e verifica se o participante votou em cada uma delas. Se o participante tiver votado em uma proposta, a contagem de votos para essa proposta será incrementada.

Por fim, a função init é chamada quando o contrato é criado. Ela inicializa as variáveis propuestas e votos com valores vazios e salva uma instância do recurso Administrar na storage do contrato.

Espero que isso tenha ajudado a entender como programar um smart contract em Cadence para votações. Se tiver mais perguntas ou precisar de mais assistência, não hesite em perguntar.
